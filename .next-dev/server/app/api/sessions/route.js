/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/sessions/route";
exports.ids = ["app/api/sessions/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fsessions%2Froute&page=%2Fapi%2Fsessions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsessions%2Froute.ts&appDir=D%3A%5CDelta%20IV%5CSofwares%5Cglass%5Csandbox%5Cshadcn-crm-dashboard%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CDelta%20IV%5CSofwares%5Cglass%5Csandbox%5Cshadcn-crm-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fsessions%2Froute&page=%2Fapi%2Fsessions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsessions%2Froute.ts&appDir=D%3A%5CDelta%20IV%5CSofwares%5Cglass%5Csandbox%5Cshadcn-crm-dashboard%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CDelta%20IV%5CSofwares%5Cglass%5Csandbox%5Cshadcn-crm-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_Delta_IV_Sofwares_glass_sandbox_shadcn_crm_dashboard_src_app_api_sessions_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/sessions/route.ts */ \"(rsc)/./src/app/api/sessions/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/sessions/route\",\n        pathname: \"/api/sessions\",\n        filename: \"route\",\n        bundlePath: \"app/api/sessions/route\"\n    },\n    resolvedPagePath: \"D:\\\\Delta IV\\\\Sofwares\\\\glass\\\\sandbox\\\\shadcn-crm-dashboard\\\\src\\\\app\\\\api\\\\sessions\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Delta_IV_Sofwares_glass_sandbox_shadcn_crm_dashboard_src_app_api_sessions_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNS4yLjJfcmVhY3QtZG9tQDE5LjEuMV9yZWFjdEAxOS4xLjFfX3JlYWN0QDE5LjEuMS9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZzZXNzaW9ucyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGc2Vzc2lvbnMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZzZXNzaW9ucyUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDRGVsdGElMjBJViU1Q1NvZndhcmVzJTVDZ2xhc3MlNUNzYW5kYm94JTVDc2hhZGNuLWNybS1kYXNoYm9hcmQlNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNEZWx0YSUyMElWJTVDU29md2FyZXMlNUNnbGFzcyU1Q3NhbmRib3glNUNzaGFkY24tY3JtLWRhc2hib2FyZCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDK0M7QUFDNUg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxzREFBc0Q7QUFDOUQ7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDMEY7O0FBRTFGIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkQ6XFxcXERlbHRhIElWXFxcXFNvZndhcmVzXFxcXGdsYXNzXFxcXHNhbmRib3hcXFxcc2hhZGNuLWNybS1kYXNoYm9hcmRcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcc2Vzc2lvbnNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3Nlc3Npb25zL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc2Vzc2lvbnNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3Nlc3Npb25zL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRDpcXFxcRGVsdGEgSVZcXFxcU29md2FyZXNcXFxcZ2xhc3NcXFxcc2FuZGJveFxcXFxzaGFkY24tY3JtLWRhc2hib2FyZFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxzZXNzaW9uc1xcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fsessions%2Froute&page=%2Fapi%2Fsessions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsessions%2Froute.ts&appDir=D%3A%5CDelta%20IV%5CSofwares%5Cglass%5Csandbox%5Cshadcn-crm-dashboard%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CDelta%20IV%5CSofwares%5Cglass%5Csandbox%5Cshadcn-crm-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!*********************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \*********************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/sessions/route.ts":
/*!***************************************!*\
  !*** ./src/app/api/sessions/route.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.57.4/node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _server_repositories_sessions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/server/repositories/sessions */ \"(rsc)/./src/server/repositories/sessions.ts\");\n\n\n\n\nasync function getServerClient() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(\"https://hewpwluinbwaizwqhmjc.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhld3B3bHVpbmJ3YWl6d3FobWpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5MTU5NTEsImV4cCI6MjA3MjQ5MTk1MX0.jhKzLYPdixxI8zcH20kkzL1WgP9RB33FeHtO0FRY7r4\", {\n        cookies: {\n            getAll () {\n                return cookieStore.getAll();\n            },\n            setAll (cookiesToSet) {\n                cookiesToSet.forEach(({ name, value, options })=>cookieStore.set(name, value, options));\n            }\n        }\n    });\n}\nasync function GET(request) {\n    try {\n        const supabase = await getServerClient();\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Unauthorized'\n        }, {\n            status: 401\n        });\n        const { searchParams } = new URL(request.url);\n        const page = parseInt(searchParams.get('page') || '1');\n        const pageSize = parseInt(searchParams.get('pageSize') || '10');\n        const search = searchParams.get('search') || undefined;\n        const status = searchParams.get('status') || 'all';\n        const type = searchParams.get('type') || undefined;\n        const dateFrom = searchParams.get('dateFrom') || undefined;\n        const dateTo = searchParams.get('dateTo') || undefined;\n        const sort = searchParams.get('sort') || 'started_at';\n        const direction = searchParams.get('direction') || 'desc';\n        const repository = new _server_repositories_sessions__WEBPACK_IMPORTED_MODULE_3__.SessionsRepository(supabase);\n        const result = await repository.findAll({\n            filters: {\n                search,\n                status: status,\n                type,\n                dateFrom,\n                dateTo\n            },\n            sort,\n            direction,\n            page,\n            pageSize,\n            userId: user.id\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (error) {\n        console.error('Sessions API error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(request) {\n    try {\n        const supabase = await getServerClient();\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Unauthorized'\n        }, {\n            status: 401\n        });\n        const body = await request.json();\n        const repository = new _server_repositories_sessions__WEBPACK_IMPORTED_MODULE_3__.SessionsRepository(supabase);\n        const session = await repository.create(body, user.id);\n        // Log activity (best-effort)\n        __webpack_require__.e(/*! import() */ \"_rsc_src_app_api__lib_log-activity_ts\").then(__webpack_require__.bind(__webpack_require__, /*! @/app/api/_lib/log-activity */ \"(rsc)/./src/app/api/_lib/log-activity.ts\")).then(async ({ logActivity })=>{\n            await logActivity(supabase, user.id, {\n                type: 'user',\n                description: `Session started: ${session.type || 'ask'}`,\n                entity: session.id,\n                details: {\n                    id: session.id\n                }\n            });\n        }).catch(()=>{});\n        // Trigger Summary + Chance of Sale generation (best-effort, fire-and-forget)\n        try {\n            await fetch(`${new URL(request.url).origin}/api/sessions/${session.id}/summary`, {\n                method: 'POST'\n            });\n            await fetch(`${new URL(request.url).origin}/api/sessions/${session.id}/chance-of-sale`, {\n                method: 'POST'\n            });\n        } catch  {}\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(session, {\n            status: 201\n        });\n    } catch (error) {\n        console.error('Session creation error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Failed to create session'\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9zZXNzaW9ucy9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBdUQ7QUFDTDtBQUNaO0FBQzZCO0FBRW5FLGVBQWVJO0lBQ2QsTUFBTUMsY0FBYyxNQUFNSCxxREFBT0E7SUFDakMsT0FBT0QsaUVBQWtCQSxDQUN4QkssMENBQW9DLEVBQ3BDQSxrTkFBeUMsRUFDekM7UUFDQ0osU0FBUztZQUNSUTtnQkFDQyxPQUFPTCxZQUFZSyxNQUFNO1lBQzFCO1lBQ0FDLFFBQU9DLFlBQVk7Z0JBQ2xCQSxhQUFhQyxPQUFPLENBQUMsQ0FBQyxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRUMsT0FBTyxFQUFFLEdBQUtYLFlBQVlZLEdBQUcsQ0FBQ0gsTUFBTUMsT0FBT0M7WUFDakY7UUFDRDtJQUNEO0FBRUY7QUFFTyxlQUFlRSxJQUFJQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0gsTUFBTUMsV0FBVyxNQUFNaEI7UUFDdkIsTUFBTSxFQUFFaUIsTUFBTSxFQUFFQyxJQUFJLEVBQUUsRUFBRSxHQUFHLE1BQU1GLFNBQVNHLElBQUksQ0FBQ0MsT0FBTztRQUN0RCxJQUFJLENBQUNGLE1BQU0sT0FBT3RCLHFEQUFZQSxDQUFDeUIsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBZSxHQUFHO1lBQUVDLFFBQVE7UUFBSTtRQUU3RSxNQUFNLEVBQUVDLFlBQVksRUFBRSxHQUFHLElBQUlDLElBQUlWLFFBQVFXLEdBQUc7UUFDNUMsTUFBTUMsT0FBT0MsU0FBU0osYUFBYUssR0FBRyxDQUFDLFdBQVc7UUFDbEQsTUFBTUMsV0FBV0YsU0FBU0osYUFBYUssR0FBRyxDQUFDLGVBQWU7UUFDMUQsTUFBTUUsU0FBU1AsYUFBYUssR0FBRyxDQUFDLGFBQWFHO1FBQzdDLE1BQU1ULFNBQVNDLGFBQWFLLEdBQUcsQ0FBQyxhQUFhO1FBQzdDLE1BQU1JLE9BQU9ULGFBQWFLLEdBQUcsQ0FBQyxXQUFXRztRQUN6QyxNQUFNRSxXQUFXVixhQUFhSyxHQUFHLENBQUMsZUFBZUc7UUFDakQsTUFBTUcsU0FBU1gsYUFBYUssR0FBRyxDQUFDLGFBQWFHO1FBQzdDLE1BQU1JLE9BQU9aLGFBQWFLLEdBQUcsQ0FBQyxXQUFXO1FBQ3pDLE1BQU1RLFlBQWFiLGFBQWFLLEdBQUcsQ0FBQyxnQkFBZ0I7UUFFcEQsTUFBTVMsYUFBYSxJQUFJdkMsNkVBQWtCQSxDQUFDaUI7UUFDMUMsTUFBTXVCLFNBQVMsTUFBTUQsV0FBV0UsT0FBTyxDQUFDO1lBQ3ZDQyxTQUFTO2dCQUFFVjtnQkFBUVIsUUFBUUE7Z0JBQWVVO2dCQUFNQztnQkFBVUM7WUFBTztZQUNqRUM7WUFDQUM7WUFDQVY7WUFDQUc7WUFDQVksUUFBUXhCLEtBQUt5QixFQUFFO1FBQ2hCO1FBQ0EsT0FBTy9DLHFEQUFZQSxDQUFDeUIsSUFBSSxDQUFDa0I7SUFDMUIsRUFBRSxPQUFPakIsT0FBTztRQUNmc0IsUUFBUXRCLEtBQUssQ0FBQyx1QkFBdUJBO1FBQ3JDLE9BQU8xQixxREFBWUEsQ0FBQ3lCLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQXdCLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQzVFO0FBQ0Q7QUFFTyxlQUFlc0IsS0FBSzlCLE9BQW9CO0lBQzlDLElBQUk7UUFDSCxNQUFNQyxXQUFXLE1BQU1oQjtRQUN2QixNQUFNLEVBQUVpQixNQUFNLEVBQUVDLElBQUksRUFBRSxFQUFFLEdBQUcsTUFBTUYsU0FBU0csSUFBSSxDQUFDQyxPQUFPO1FBQ3RELElBQUksQ0FBQ0YsTUFBTSxPQUFPdEIscURBQVlBLENBQUN5QixJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFlLEdBQUc7WUFBRUMsUUFBUTtRQUFJO1FBRTdFLE1BQU11QixPQUFPLE1BQU0vQixRQUFRTSxJQUFJO1FBQy9CLE1BQU1pQixhQUFhLElBQUl2Qyw2RUFBa0JBLENBQUNpQjtRQUMxQyxNQUFNK0IsVUFBVSxNQUFNVCxXQUFXVSxNQUFNLENBQUNGLE1BQU01QixLQUFLeUIsRUFBRTtRQUNyRCw2QkFBNkI7UUFDN0IsaU5BQXFDLENBQUNNLElBQUksQ0FBQyxPQUFPLEVBQUVDLFdBQVcsRUFBRTtZQUNoRSxNQUFNQSxZQUFZbEMsVUFBaUJFLEtBQUt5QixFQUFFLEVBQUU7Z0JBQzNDVixNQUFNO2dCQUNOa0IsYUFBYSxDQUFDLGlCQUFpQixFQUFFLFFBQWlCbEIsSUFBSSxJQUFJLE9BQU87Z0JBQ2pFbUIsUUFBUSxRQUFpQlQsRUFBRTtnQkFDM0JVLFNBQVM7b0JBQUVWLElBQUksUUFBaUJBLEVBQUU7Z0JBQUM7WUFDcEM7UUFDRCxHQUFHVyxLQUFLLENBQUMsS0FBTztRQUNoQiw2RUFBNkU7UUFDN0UsSUFBSTtZQUNILE1BQU1DLE1BQU0sR0FBRyxJQUFJOUIsSUFBSVYsUUFBUVcsR0FBRyxFQUFFOEIsTUFBTSxDQUFDLGNBQWMsRUFBRSxRQUFpQmIsRUFBRSxDQUFDLFFBQVEsQ0FBQyxFQUFFO2dCQUFFYyxRQUFRO1lBQU87WUFDM0csTUFBTUYsTUFBTSxHQUFHLElBQUk5QixJQUFJVixRQUFRVyxHQUFHLEVBQUU4QixNQUFNLENBQUMsY0FBYyxFQUFFLFFBQWlCYixFQUFFLENBQUMsZUFBZSxDQUFDLEVBQUU7Z0JBQUVjLFFBQVE7WUFBTztRQUNuSCxFQUFFLE9BQU0sQ0FBQztRQUNULE9BQU83RCxxREFBWUEsQ0FBQ3lCLElBQUksQ0FBQzBCLFNBQVM7WUFBRXhCLFFBQVE7UUFBSTtJQUNqRCxFQUFFLE9BQU9ELE9BQU87UUFDZnNCLFFBQVF0QixLQUFLLENBQUMsMkJBQTJCQTtRQUN6QyxPQUFPMUIscURBQVlBLENBQUN5QixJQUFJLENBQUM7WUFBRUMsT0FBTztRQUEyQixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUMvRTtBQUNEIiwic291cmNlcyI6WyJEOlxcRGVsdGEgSVZcXFNvZndhcmVzXFxnbGFzc1xcc2FuZGJveFxcc2hhZGNuLWNybS1kYXNoYm9hcmRcXHNyY1xcYXBwXFxhcGlcXHNlc3Npb25zXFxyb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBjcmVhdGVTZXJ2ZXJDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3NyJ1xuaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycydcbmltcG9ydCB7IFNlc3Npb25zUmVwb3NpdG9yeSB9IGZyb20gJ0Avc2VydmVyL3JlcG9zaXRvcmllcy9zZXNzaW9ucydcblxuYXN5bmMgZnVuY3Rpb24gZ2V0U2VydmVyQ2xpZW50KCkge1xuXHRjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKVxuXHRyZXR1cm4gY3JlYXRlU2VydmVyQ2xpZW50KFxuXHRcdHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG5cdFx0cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxuXHRcdHtcblx0XHRcdGNvb2tpZXM6IHtcblx0XHRcdFx0Z2V0QWxsKCkge1xuXHRcdFx0XHRcdHJldHVybiBjb29raWVTdG9yZS5nZXRBbGwoKVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRzZXRBbGwoY29va2llc1RvU2V0KSB7XG5cdFx0XHRcdFx0Y29va2llc1RvU2V0LmZvckVhY2goKHsgbmFtZSwgdmFsdWUsIG9wdGlvbnMgfSkgPT4gY29va2llU3RvcmUuc2V0KG5hbWUsIHZhbHVlLCBvcHRpb25zKSlcblx0XHRcdFx0fSxcblx0XHRcdH0sXG5cdFx0fVxuXHQpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcblx0dHJ5IHtcblx0XHRjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGdldFNlcnZlckNsaWVudCgpXG5cdFx0Y29uc3QgeyBkYXRhOiB7IHVzZXIgfSB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKClcblx0XHRpZiAoIXVzZXIpIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pXG5cblx0XHRjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybClcblx0XHRjb25zdCBwYWdlID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgncGFnZScpIHx8ICcxJylcblx0XHRjb25zdCBwYWdlU2l6ZSA9IHBhcnNlSW50KHNlYXJjaFBhcmFtcy5nZXQoJ3BhZ2VTaXplJykgfHwgJzEwJylcblx0XHRjb25zdCBzZWFyY2ggPSBzZWFyY2hQYXJhbXMuZ2V0KCdzZWFyY2gnKSB8fCB1bmRlZmluZWRcblx0XHRjb25zdCBzdGF0dXMgPSBzZWFyY2hQYXJhbXMuZ2V0KCdzdGF0dXMnKSB8fCAnYWxsJ1xuXHRcdGNvbnN0IHR5cGUgPSBzZWFyY2hQYXJhbXMuZ2V0KCd0eXBlJykgfHwgdW5kZWZpbmVkXG5cdFx0Y29uc3QgZGF0ZUZyb20gPSBzZWFyY2hQYXJhbXMuZ2V0KCdkYXRlRnJvbScpIHx8IHVuZGVmaW5lZFxuXHRcdGNvbnN0IGRhdGVUbyA9IHNlYXJjaFBhcmFtcy5nZXQoJ2RhdGVUbycpIHx8IHVuZGVmaW5lZFxuXHRcdGNvbnN0IHNvcnQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdzb3J0JykgfHwgJ3N0YXJ0ZWRfYXQnXG5cdFx0Y29uc3QgZGlyZWN0aW9uID0gKHNlYXJjaFBhcmFtcy5nZXQoJ2RpcmVjdGlvbicpIHx8ICdkZXNjJykgYXMgJ2FzYycgfCAnZGVzYydcblxuXHRcdGNvbnN0IHJlcG9zaXRvcnkgPSBuZXcgU2Vzc2lvbnNSZXBvc2l0b3J5KHN1cGFiYXNlKVxuXHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcG9zaXRvcnkuZmluZEFsbCh7XG5cdFx0XHRmaWx0ZXJzOiB7IHNlYXJjaCwgc3RhdHVzOiBzdGF0dXMgYXMgYW55LCB0eXBlLCBkYXRlRnJvbSwgZGF0ZVRvIH0sXG5cdFx0XHRzb3J0LFxuXHRcdFx0ZGlyZWN0aW9uLFxuXHRcdFx0cGFnZSxcblx0XHRcdHBhZ2VTaXplLFxuXHRcdFx0dXNlcklkOiB1c2VyLmlkXG5cdFx0fSlcblx0XHRyZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzdWx0KVxuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdGNvbnNvbGUuZXJyb3IoJ1Nlc3Npb25zIEFQSSBlcnJvcjonLCBlcnJvcilcblx0XHRyZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSwgeyBzdGF0dXM6IDUwMCB9KVxuXHR9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG5cdHRyeSB7XG5cdFx0Y29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBnZXRTZXJ2ZXJDbGllbnQoKVxuXHRcdGNvbnN0IHsgZGF0YTogeyB1c2VyIH0gfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpXG5cdFx0aWYgKCF1c2VyKSByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSwgeyBzdGF0dXM6IDQwMSB9KVxuXG5cdFx0Y29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG5cdFx0Y29uc3QgcmVwb3NpdG9yeSA9IG5ldyBTZXNzaW9uc1JlcG9zaXRvcnkoc3VwYWJhc2UpXG5cdFx0Y29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHJlcG9zaXRvcnkuY3JlYXRlKGJvZHksIHVzZXIuaWQpXG5cdFx0Ly8gTG9nIGFjdGl2aXR5IChiZXN0LWVmZm9ydClcblx0XHRpbXBvcnQoJ0AvYXBwL2FwaS9fbGliL2xvZy1hY3Rpdml0eScpLnRoZW4oYXN5bmMgKHsgbG9nQWN0aXZpdHkgfSkgPT4ge1xuXHRcdFx0YXdhaXQgbG9nQWN0aXZpdHkoc3VwYWJhc2UgYXMgYW55LCB1c2VyLmlkLCB7XG5cdFx0XHRcdHR5cGU6ICd1c2VyJyxcblx0XHRcdFx0ZGVzY3JpcHRpb246IGBTZXNzaW9uIHN0YXJ0ZWQ6ICR7KHNlc3Npb24gYXMgYW55KS50eXBlIHx8ICdhc2snfWAsXG5cdFx0XHRcdGVudGl0eTogKHNlc3Npb24gYXMgYW55KS5pZCxcblx0XHRcdFx0ZGV0YWlsczogeyBpZDogKHNlc3Npb24gYXMgYW55KS5pZCB9XG5cdFx0XHR9KVxuXHRcdH0pLmNhdGNoKCgpID0+IHt9KVxuXHRcdC8vIFRyaWdnZXIgU3VtbWFyeSArIENoYW5jZSBvZiBTYWxlIGdlbmVyYXRpb24gKGJlc3QtZWZmb3J0LCBmaXJlLWFuZC1mb3JnZXQpXG5cdFx0dHJ5IHtcblx0XHRcdGF3YWl0IGZldGNoKGAke25ldyBVUkwocmVxdWVzdC51cmwpLm9yaWdpbn0vYXBpL3Nlc3Npb25zLyR7KHNlc3Npb24gYXMgYW55KS5pZH0vc3VtbWFyeWAsIHsgbWV0aG9kOiAnUE9TVCcgfSlcblx0XHRcdGF3YWl0IGZldGNoKGAke25ldyBVUkwocmVxdWVzdC51cmwpLm9yaWdpbn0vYXBpL3Nlc3Npb25zLyR7KHNlc3Npb24gYXMgYW55KS5pZH0vY2hhbmNlLW9mLXNhbGVgLCB7IG1ldGhvZDogJ1BPU1QnIH0pXG5cdFx0fSBjYXRjaCB7fVxuXHRcdHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihzZXNzaW9uLCB7IHN0YXR1czogMjAxIH0pXG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcignU2Vzc2lvbiBjcmVhdGlvbiBlcnJvcjonLCBlcnJvcilcblx0XHRyZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byBjcmVhdGUgc2Vzc2lvbicgfSwgeyBzdGF0dXM6IDUwMCB9KVxuXHR9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3JlYXRlU2VydmVyQ2xpZW50IiwiY29va2llcyIsIlNlc3Npb25zUmVwb3NpdG9yeSIsImdldFNlcnZlckNsaWVudCIsImNvb2tpZVN0b3JlIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiZ2V0QWxsIiwic2V0QWxsIiwiY29va2llc1RvU2V0IiwiZm9yRWFjaCIsIm5hbWUiLCJ2YWx1ZSIsIm9wdGlvbnMiLCJzZXQiLCJHRVQiLCJyZXF1ZXN0Iiwic3VwYWJhc2UiLCJkYXRhIiwidXNlciIsImF1dGgiLCJnZXRVc2VyIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwicGFnZSIsInBhcnNlSW50IiwiZ2V0IiwicGFnZVNpemUiLCJzZWFyY2giLCJ1bmRlZmluZWQiLCJ0eXBlIiwiZGF0ZUZyb20iLCJkYXRlVG8iLCJzb3J0IiwiZGlyZWN0aW9uIiwicmVwb3NpdG9yeSIsInJlc3VsdCIsImZpbmRBbGwiLCJmaWx0ZXJzIiwidXNlcklkIiwiaWQiLCJjb25zb2xlIiwiUE9TVCIsImJvZHkiLCJzZXNzaW9uIiwiY3JlYXRlIiwidGhlbiIsImxvZ0FjdGl2aXR5IiwiZGVzY3JpcHRpb24iLCJlbnRpdHkiLCJkZXRhaWxzIiwiY2F0Y2giLCJmZXRjaCIsIm9yaWdpbiIsIm1ldGhvZCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/sessions/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/repositories/sessions.ts":
/*!*********************************************!*\
  !*** ./src/server/repositories/sessions.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SessionsRepository: () => (/* binding */ SessionsRepository)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/.pnpm/@supabase+supabase-js@2.57.4/node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n// Use untyped client until schema is applied and types regenerated\nconst supabaseUrl = \"https://hewpwluinbwaizwqhmjc.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhld3B3bHVpbmJ3YWl6d3FobWpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5MTU5NTEsImV4cCI6MjA3MjQ5MTk1MX0.jhKzLYPdixxI8zcH20kkzL1WgP9RB33FeHtO0FRY7r4\";\nconst defaultClient = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\nfunction mapDbSession(row) {\n    const startedAt = row.started_at ? new Date(row.started_at) : null;\n    const fallbackTitle = startedAt ? `Session @ ${startedAt.toLocaleTimeString('en-GB', {\n        hour12: false\n    })}` : 'Session';\n    // Heuristic: if title_enc looks like base64/opaque, use fallback for display\n    const looksEncoded = typeof row.title_enc === 'string' && /^[A-Za-z0-9+/=]{20,}$/.test(row.title_enc);\n    return {\n        id: row.id,\n        owner_id: row.user_id,\n        subject_id: row.subject_id || null,\n        title: row.title_enc && !looksEncoded ? row.title_enc : fallbackTitle,\n        type: row.session_type,\n        status: row.ended_at ? 'completed' : 'active',\n        started_at: row.started_at,\n        ended_at: row.ended_at,\n        created_at: row.started_at,\n        updated_at: row.updated_at\n    };\n}\nclass SessionsRepository {\n    constructor(supabase = defaultClient){\n        this.supabase = supabase;\n    }\n    async findAll(options) {\n        const { filters = {}, sort = 'started_at', direction = 'desc', page = 1, pageSize = 10, userId } = options;\n        const sortColumn = [\n            'started_at',\n            'updated_at',\n            'ended_at'\n        ].includes(sort) ? sort : 'started_at';\n        let query = this.supabase.from('sessions').select('id,user_id,subject_id,title_enc,session_type,started_at,ended_at,updated_at', {\n            count: 'estimated'\n        }).eq('user_id', userId);\n        // Apply filters\n        if (filters.search) {\n            query = query.ilike('title_enc', `%${filters.search}%`);\n        }\n        if (filters.status && filters.status !== 'all') {\n            if (filters.status === 'active') {\n                query = query.is('ended_at', null);\n            } else if (filters.status === 'completed' || filters.status === 'cancelled') {\n                query = query.not('ended_at', 'is', null);\n            }\n        }\n        if (filters.type) {\n            query = query.eq('session_type', filters.type);\n        }\n        if (filters.dateFrom) {\n            query = query.gte('started_at', filters.dateFrom);\n        }\n        if (filters.dateTo) {\n            query = query.lte('started_at', filters.dateTo);\n        }\n        // Apply sorting\n        query = query.order(sortColumn, {\n            ascending: direction === 'asc'\n        });\n        // Apply pagination (1-based to 0-based conversion)\n        const from = (page - 1) * pageSize;\n        const to = from + pageSize - 1;\n        query = query.range(from, to);\n        const { data: rows, error, count } = await query;\n        if (error) {\n            throw new Error(`Failed to fetch sessions: ${error.message}`);\n        }\n        const baseRows = rows || [];\n        // Enrich with contact phone via subject lookup (prefer customer over lead)\n        const phoneBySubject = {};\n        const subjectIds = Array.from(new Set(baseRows.map((r)=>r.subject_id).filter((v)=>!!v)));\n        if (subjectIds.length > 0) {\n            // Fetch customer phones in bulk\n            const { data: custRows, error: custErr } = await this.supabase.from('customers').select('subject_id, phone').in('subject_id', subjectIds).eq('owner_id', userId);\n            if (!custErr && Array.isArray(custRows)) {\n                for (const r of custRows){\n                    if (r.subject_id && r.phone) phoneBySubject[r.subject_id] = r.phone;\n                }\n            }\n            // Fetch lead phones where customer missing\n            const missing = subjectIds.filter((id)=>!phoneBySubject[id]);\n            if (missing.length > 0) {\n                const { data: leadRows } = await this.supabase.from('leads').select('subject_id, phone').in('subject_id', missing).eq('owner_id', userId);\n                if (Array.isArray(leadRows)) {\n                    for (const r of leadRows){\n                        if (r.subject_id && r.phone && !phoneBySubject[r.subject_id]) {\n                            phoneBySubject[r.subject_id] = r.phone;\n                        }\n                    }\n                }\n            }\n        }\n        const sessions = baseRows.map((r)=>{\n            const s = mapDbSession(r);\n            const phone = r.subject_id ? phoneBySubject[r.subject_id] : undefined;\n            return phone ? {\n                ...s,\n                phone\n            } : s;\n        });\n        const total = count || 0;\n        const totalPages = Math.ceil(total / pageSize);\n        return {\n            sessions,\n            total,\n            page,\n            pageSize,\n            totalPages\n        };\n    }\n    async findById(id, userId) {\n        const { data: row, error } = await this.supabase.from('sessions').select('id,user_id,subject_id,title_enc,session_type,started_at,ended_at,updated_at').eq('id', id).eq('user_id', userId).single();\n        if (error) {\n            if (error.code === 'PGRST116') {\n                return null // Not found\n                ;\n            }\n            throw new Error(`Failed to fetch session: ${error.message}`);\n        }\n        return mapDbSession(row);\n    }\n    async create(sessionData, userId) {\n        const requestedType = sessionData?.type || 'ask';\n        const { data: newSessionId, error: rpcError } = await this.supabase.rpc('get_or_create_active_session', {\n            requested_type: requestedType\n        });\n        if (rpcError) {\n            throw new Error(`Failed to create session: ${rpcError.message}`);\n        }\n        const { data: row, error } = await this.supabase.from('sessions').select('id,user_id,subject_id,title_enc,session_type,started_at,ended_at,updated_at').eq('id', newSessionId).eq('user_id', userId).single();\n        if (error) {\n            throw new Error(`Failed to fetch created session: ${error.message}`);\n        }\n        return mapDbSession(row);\n    }\n    async update(id, sessionData, userId) {\n        // Support title update and ending a session\n        if (sessionData?.status === 'completed' || sessionData?.status === 'cancelled') {\n            const { error: endErr } = await this.supabase.rpc('end_session', {\n                session_id: id\n            });\n            if (endErr) throw new Error(`Failed to end session: ${endErr.message}`);\n        }\n        if (sessionData?.title) {\n            const { error: updErr } = await this.supabase.from('sessions').update({\n                title_enc: sessionData.title\n            }).eq('id', id).eq('user_id', userId);\n            if (updErr) throw new Error(`Failed to update session: ${updErr.message}`);\n        }\n        const { data: row, error } = await this.supabase.from('sessions').select('id,user_id,subject_id,title_enc,session_type,started_at,ended_at,updated_at').eq('id', id).eq('user_id', userId).single();\n        if (error) throw new Error(`Failed to fetch session: ${error.message}`);\n        return mapDbSession(row);\n    }\n    async delete(id, userId) {\n        const { error } = await this.supabase.from('sessions').delete().eq('id', id).eq('user_id', userId);\n        if (error) throw new Error(`Failed to delete session: ${error.message}`);\n    }\n    async getStats(userId) {\n        const [total, active, completed] = await Promise.all([\n            this.supabase.from('sessions').select('*', {\n                count: 'exact',\n                head: true\n            }).eq('user_id', userId),\n            this.supabase.from('sessions').select('*', {\n                count: 'exact',\n                head: true\n            }).eq('user_id', userId).is('ended_at', null),\n            this.supabase.from('sessions').select('*', {\n                count: 'exact',\n                head: true\n            }).eq('user_id', userId).not('ended_at', 'is', null)\n        ]);\n        return {\n            total: total.count || 0,\n            active: active.count || 0,\n            completed: completed.count || 0,\n            cancelled: 0\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmVyL3JlcG9zaXRvcmllcy9zZXNzaW9ucy50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFvRDtBQUVwRCxtRUFBbUU7QUFDbkUsTUFBTUMsY0FBY0MsMENBQW9DO0FBQ3hELE1BQU1HLGtCQUFrQkgsa05BQXlDO0FBQ2pFLE1BQU1LLGdCQUFnQlAsbUVBQVlBLENBQUNDLGFBQWFJO0FBMEJoRCxTQUFTRyxhQUFhQyxHQUFRO0lBQzdCLE1BQU1DLFlBQVlELElBQUlFLFVBQVUsR0FBRyxJQUFJQyxLQUFLSCxJQUFJRSxVQUFVLElBQUk7SUFDOUQsTUFBTUUsZ0JBQWdCSCxZQUFZLENBQUMsVUFBVSxFQUFFQSxVQUFVSSxrQkFBa0IsQ0FBQyxTQUFTO1FBQUVDLFFBQVE7SUFBTSxJQUFJLEdBQUc7SUFDNUcsNkVBQTZFO0lBQzdFLE1BQU1DLGVBQWUsT0FBT1AsSUFBSVEsU0FBUyxLQUFLLFlBQVksd0JBQXdCQyxJQUFJLENBQUNULElBQUlRLFNBQVM7SUFDcEcsT0FBTztRQUNORSxJQUFJVixJQUFJVSxFQUFFO1FBQ1ZDLFVBQVVYLElBQUlZLE9BQU87UUFDckJDLFlBQVliLElBQUlhLFVBQVUsSUFBSTtRQUM5QkMsT0FBTyxJQUFLTixTQUFTLElBQUksQ0FBQ0QsZUFBZ0JQLElBQUlRLFNBQVMsR0FBR0o7UUFDMURXLE1BQU1mLElBQUlnQixZQUFZO1FBQ3RCQyxRQUFRakIsSUFBSWtCLFFBQVEsR0FBRyxjQUFjO1FBQ3JDaEIsWUFBWUYsSUFBSUUsVUFBVTtRQUMxQmdCLFVBQVVsQixJQUFJa0IsUUFBUTtRQUN0QkMsWUFBWW5CLElBQUlFLFVBQVU7UUFDMUJrQixZQUFZcEIsSUFBSW9CLFVBQVU7SUFDM0I7QUFDRDtBQUVPLE1BQU1DO0lBQ1RDLFlBQVksV0FBc0N4QixhQUFhLENBQUU7YUFBN0N5QixXQUFBQTtJQUE4QztJQUVsRSxNQUFNQyxRQUFRQyxPQUEyQixFQU10QztRQUNMLE1BQU0sRUFDTEMsVUFBVSxDQUFDLENBQUMsRUFDWkMsT0FBTyxZQUFZLEVBQ25CQyxZQUFZLE1BQU0sRUFDbEJDLE9BQU8sQ0FBQyxFQUNSQyxXQUFXLEVBQUUsRUFDYkMsTUFBTSxFQUNOLEdBQUdOO1FBRUosTUFBTU8sYUFBYTtZQUFDO1lBQWE7WUFBYTtTQUFXLENBQUNDLFFBQVEsQ0FBQ04sUUFBUUEsT0FBTztRQUVsRixJQUFJTyxRQUFRLElBQUksQ0FBQ1gsUUFBUSxDQUN2QlksSUFBSSxDQUFDLFlBQ0xDLE1BQU0sQ0FBQywrRUFBK0U7WUFBRUMsT0FBTztRQUFZLEdBQzNHQyxFQUFFLENBQUMsV0FBV1A7UUFFaEIsZ0JBQWdCO1FBQ2hCLElBQUlMLFFBQVFhLE1BQU0sRUFBRTtZQUNuQkwsUUFBUUEsTUFBTU0sS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDLEVBQUVkLFFBQVFhLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDdkQ7UUFFQSxJQUFJYixRQUFRVCxNQUFNLElBQUlTLFFBQVFULE1BQU0sS0FBSyxPQUFPO1lBQy9DLElBQUlTLFFBQVFULE1BQU0sS0FBSyxVQUFVO2dCQUNoQ2lCLFFBQVFBLE1BQU1PLEVBQUUsQ0FBQyxZQUFZO1lBQzlCLE9BQU8sSUFBSWYsUUFBUVQsTUFBTSxLQUFLLGVBQWVTLFFBQVFULE1BQU0sS0FBSyxhQUFhO2dCQUM1RWlCLFFBQVFBLE1BQU1RLEdBQUcsQ0FBQyxZQUFZLE1BQU07WUFDckM7UUFDRDtRQUVBLElBQUloQixRQUFRWCxJQUFJLEVBQUU7WUFDakJtQixRQUFRQSxNQUFNSSxFQUFFLENBQUMsZ0JBQWdCWixRQUFRWCxJQUFJO1FBQzlDO1FBRUEsSUFBSVcsUUFBUWlCLFFBQVEsRUFBRTtZQUNyQlQsUUFBUUEsTUFBTVUsR0FBRyxDQUFDLGNBQWNsQixRQUFRaUIsUUFBUTtRQUNqRDtRQUVBLElBQUlqQixRQUFRbUIsTUFBTSxFQUFFO1lBQ25CWCxRQUFRQSxNQUFNWSxHQUFHLENBQUMsY0FBY3BCLFFBQVFtQixNQUFNO1FBQy9DO1FBRUEsZ0JBQWdCO1FBQ2hCWCxRQUFRQSxNQUFNYSxLQUFLLENBQUNmLFlBQVk7WUFBRWdCLFdBQVdwQixjQUFjO1FBQU07UUFFakUsbURBQW1EO1FBQ25ELE1BQU1PLE9BQU8sQ0FBQ04sT0FBTyxLQUFLQztRQUMxQixNQUFNbUIsS0FBS2QsT0FBT0wsV0FBVztRQUM3QkksUUFBUUEsTUFBTWdCLEtBQUssQ0FBQ2YsTUFBTWM7UUFFcEIsTUFBTSxFQUFFRSxNQUFNQyxJQUFJLEVBQUVDLEtBQUssRUFBRWhCLEtBQUssRUFBRSxHQUFHLE1BQU1IO1FBRTNDLElBQUltQixPQUFPO1lBQ1AsTUFBTSxJQUFJQyxNQUFNLENBQUMsMEJBQTBCLEVBQUVELE1BQU1FLE9BQU8sRUFBRTtRQUNoRTtRQUVBLE1BQU1DLFdBQVdKLFFBQVEsRUFBRTtRQUUzQiwyRUFBMkU7UUFDM0UsTUFBTUssaUJBQXlDLENBQUM7UUFDaEQsTUFBTUMsYUFBYUMsTUFBTXhCLElBQUksQ0FBQyxJQUFJeUIsSUFDOUJKLFNBQVNLLEdBQUcsQ0FBQyxDQUFDQyxJQUFXQSxFQUFFakQsVUFBVSxFQUFFa0QsTUFBTSxDQUFDLENBQUNDLElBQVcsQ0FBQyxDQUFDQTtRQUdoRSxJQUFJTixXQUFXTyxNQUFNLEdBQUcsR0FBRztZQUN2QixnQ0FBZ0M7WUFDaEMsTUFBTSxFQUFFZCxNQUFNZSxRQUFRLEVBQUViLE9BQU9jLE9BQU8sRUFBRSxHQUFHLE1BQU0sSUFBSSxDQUFDNUMsUUFBUSxDQUN6RFksSUFBSSxDQUFDLGFBQ0xDLE1BQU0sQ0FBQyxxQkFDUGdDLEVBQUUsQ0FBQyxjQUFjVixZQUNqQnBCLEVBQUUsQ0FBQyxZQUFZUDtZQUNwQixJQUFJLENBQUNvQyxXQUFXUixNQUFNVSxPQUFPLENBQUNILFdBQVc7Z0JBQ3JDLEtBQUssTUFBTUosS0FBS0ksU0FBVTtvQkFDdEIsSUFBSUosRUFBRWpELFVBQVUsSUFBSWlELEVBQUVRLEtBQUssRUFBRWIsY0FBYyxDQUFDSyxFQUFFakQsVUFBVSxDQUFDLEdBQUdpRCxFQUFFUSxLQUFLO2dCQUN2RTtZQUNKO1lBRUEsMkNBQTJDO1lBQzNDLE1BQU1DLFVBQVViLFdBQVdLLE1BQU0sQ0FBQ3JELENBQUFBLEtBQU0sQ0FBQytDLGNBQWMsQ0FBQy9DLEdBQUc7WUFDM0QsSUFBSTZELFFBQVFOLE1BQU0sR0FBRyxHQUFHO2dCQUNwQixNQUFNLEVBQUVkLE1BQU1xQixRQUFRLEVBQUUsR0FBRyxNQUFNLElBQUksQ0FBQ2pELFFBQVEsQ0FDekNZLElBQUksQ0FBQyxTQUNMQyxNQUFNLENBQUMscUJBQ1BnQyxFQUFFLENBQUMsY0FBY0csU0FDakJqQyxFQUFFLENBQUMsWUFBWVA7Z0JBQ3BCLElBQUk0QixNQUFNVSxPQUFPLENBQUNHLFdBQVc7b0JBQ3pCLEtBQUssTUFBTVYsS0FBS1UsU0FBVTt3QkFDdEIsSUFBSVYsRUFBRWpELFVBQVUsSUFBSWlELEVBQUVRLEtBQUssSUFBSSxDQUFDYixjQUFjLENBQUNLLEVBQUVqRCxVQUFVLENBQUMsRUFBRTs0QkFDMUQ0QyxjQUFjLENBQUNLLEVBQUVqRCxVQUFVLENBQUMsR0FBR2lELEVBQUVRLEtBQUs7d0JBQzFDO29CQUNKO2dCQUNKO1lBQ0o7UUFDSjtRQUVBLE1BQU1HLFdBQVdqQixTQUFTSyxHQUFHLENBQUMsQ0FBQ0M7WUFDM0IsTUFBTVksSUFBSTNFLGFBQWErRDtZQUN2QixNQUFNUSxRQUFRUixFQUFFakQsVUFBVSxHQUFHNEMsY0FBYyxDQUFDSyxFQUFFakQsVUFBVSxDQUFDLEdBQUc4RDtZQUM1RCxPQUFPTCxRQUFRO2dCQUFFLEdBQUdJLENBQUM7Z0JBQUVKO1lBQU0sSUFBSUk7UUFDckM7UUFDQSxNQUFNRSxRQUFRdkMsU0FBUztRQUN2QixNQUFNd0MsYUFBYUMsS0FBS0MsSUFBSSxDQUFDSCxRQUFROUM7UUFFckMsT0FBTztZQUFFMkM7WUFBVUc7WUFBTy9DO1lBQU1DO1lBQVUrQztRQUFXO0lBQ3pEO0lBRUgsTUFBTUcsU0FBU3RFLEVBQVUsRUFBRXFCLE1BQWMsRUFBMkI7UUFDbkUsTUFBTSxFQUFFb0IsTUFBTW5ELEdBQUcsRUFBRXFELEtBQUssRUFBRSxHQUFHLE1BQU0sSUFBSSxDQUFDOUIsUUFBUSxDQUM5Q1ksSUFBSSxDQUFDLFlBQ0xDLE1BQU0sQ0FBQywrRUFDUEUsRUFBRSxDQUFDLE1BQU01QixJQUNUNEIsRUFBRSxDQUFDLFdBQVdQLFFBQ2RrRCxNQUFNO1FBRVIsSUFBSTVCLE9BQU87WUFDVixJQUFJLE1BQWU2QixJQUFJLEtBQUssWUFBWTtnQkFDdkMsT0FBTyxLQUFLLFlBQVk7O1lBQ3pCO1lBQ0EsTUFBTSxJQUFJNUIsTUFBTSxDQUFDLHlCQUF5QixFQUFFRCxNQUFNRSxPQUFPLEVBQUU7UUFDNUQ7UUFFQSxPQUFPeEQsYUFBYUM7SUFDckI7SUFFQSxNQUFNbUYsT0FBT0MsV0FBMEIsRUFBRXJELE1BQWMsRUFBb0I7UUFDMUUsTUFBTXNELGdCQUFnQixhQUFzQnRFLFFBQVE7UUFDcEQsTUFBTSxFQUFFb0MsTUFBTW1DLFlBQVksRUFBRWpDLE9BQU9rQyxRQUFRLEVBQUUsR0FBRyxNQUFNLElBQUssQ0FBQ2hFLFFBQVEsQ0FDbEVpRSxHQUFHLENBQUMsZ0NBQWdDO1lBQUVDLGdCQUFnQko7UUFBYztRQUV0RSxJQUFJRSxVQUFVO1lBQ2IsTUFBTSxJQUFJakMsTUFBTSxDQUFDLDBCQUEwQixFQUFFaUMsU0FBU2hDLE9BQU8sRUFBRTtRQUNoRTtRQUVBLE1BQU0sRUFBRUosTUFBTW5ELEdBQUcsRUFBRXFELEtBQUssRUFBRSxHQUFHLE1BQU0sSUFBSSxDQUFDOUIsUUFBUSxDQUM5Q1ksSUFBSSxDQUFDLFlBQ0xDLE1BQU0sQ0FBQywrRUFDUEUsRUFBRSxDQUFDLE1BQU1nRCxjQUNUaEQsRUFBRSxDQUFDLFdBQVdQLFFBQ2RrRCxNQUFNO1FBRVIsSUFBSTVCLE9BQU87WUFDVixNQUFNLElBQUlDLE1BQU0sQ0FBQyxpQ0FBaUMsRUFBRUQsTUFBTUUsT0FBTyxFQUFFO1FBQ3BFO1FBRUEsT0FBT3hELGFBQWFDO0lBQ3JCO0lBRUEsTUFBTTBGLE9BQU9oRixFQUFVLEVBQUUwRSxXQUEwQixFQUFFckQsTUFBYyxFQUFvQjtRQUN0Riw0Q0FBNEM7UUFDNUMsSUFBSSxhQUFzQmQsV0FBVyxlQUFlLGFBQXNCQSxXQUFXLGFBQWE7WUFDakcsTUFBTSxFQUFFb0MsT0FBT3NDLE1BQU0sRUFBRSxHQUFHLE1BQU0sSUFBSyxDQUFDcEUsUUFBUSxDQUFTaUUsR0FBRyxDQUFDLGVBQWU7Z0JBQUVJLFlBQVlsRjtZQUFHO1lBQzNGLElBQUlpRixRQUFRLE1BQU0sSUFBSXJDLE1BQU0sQ0FBQyx1QkFBdUIsRUFBRXFDLE9BQU9wQyxPQUFPLEVBQUU7UUFDdkU7UUFFQSxJQUFLNkIsYUFBcUJ0RSxPQUFPO1lBQ2hDLE1BQU0sRUFBRXVDLE9BQU93QyxNQUFNLEVBQUUsR0FBRyxNQUFNLElBQUksQ0FBQ3RFLFFBQVEsQ0FDM0NZLElBQUksQ0FBQyxZQUNMdUQsTUFBTSxDQUFDO2dCQUFFbEYsV0FBVyxZQUFxQk0sS0FBSztZQUFDLEdBQy9Dd0IsRUFBRSxDQUFDLE1BQU01QixJQUNUNEIsRUFBRSxDQUFDLFdBQVdQO1lBQ2hCLElBQUk4RCxRQUFRLE1BQU0sSUFBSXZDLE1BQU0sQ0FBQywwQkFBMEIsRUFBRXVDLE9BQU90QyxPQUFPLEVBQUU7UUFDMUU7UUFFQSxNQUFNLEVBQUVKLE1BQU1uRCxHQUFHLEVBQUVxRCxLQUFLLEVBQUUsR0FBRyxNQUFNLElBQUksQ0FBQzlCLFFBQVEsQ0FDOUNZLElBQUksQ0FBQyxZQUNMQyxNQUFNLENBQUMsK0VBQ1BFLEVBQUUsQ0FBQyxNQUFNNUIsSUFDVDRCLEVBQUUsQ0FBQyxXQUFXUCxRQUNka0QsTUFBTTtRQUNSLElBQUk1QixPQUFPLE1BQU0sSUFBSUMsTUFBTSxDQUFDLHlCQUF5QixFQUFFRCxNQUFNRSxPQUFPLEVBQUU7UUFDdEUsT0FBT3hELGFBQWFDO0lBQ3JCO0lBRUEsTUFBTThGLE9BQU9wRixFQUFVLEVBQUVxQixNQUFjLEVBQWlCO1FBQ3ZELE1BQU0sRUFBRXNCLEtBQUssRUFBRSxHQUFHLE1BQU0sSUFBSSxDQUFDOUIsUUFBUSxDQUNuQ1ksSUFBSSxDQUFDLFlBQ0wyRCxNQUFNLEdBQ054RCxFQUFFLENBQUMsTUFBTTVCLElBQ1Q0QixFQUFFLENBQUMsV0FBV1A7UUFDaEIsSUFBSXNCLE9BQU8sTUFBTSxJQUFJQyxNQUFNLENBQUMsMEJBQTBCLEVBQUVELE1BQU1FLE9BQU8sRUFBRTtJQUN4RTtJQUVBLE1BQU13QyxTQUFTaEUsTUFBYyxFQUsxQjtRQUNGLE1BQU0sQ0FBQzZDLE9BQU9vQixRQUFRQyxVQUFVLEdBQUcsTUFBTUMsUUFBUUMsR0FBRyxDQUFDO1lBQ3BELElBQUksQ0FBQzVFLFFBQVEsQ0FBQ1ksSUFBSSxDQUFDLFlBQVlDLE1BQU0sQ0FBQyxLQUFLO2dCQUFFQyxPQUFPO2dCQUFTK0QsTUFBTTtZQUFLLEdBQUc5RCxFQUFFLENBQUMsV0FBV1A7WUFDekYsSUFBSSxDQUFDUixRQUFRLENBQUNZLElBQUksQ0FBQyxZQUFZQyxNQUFNLENBQUMsS0FBSztnQkFBRUMsT0FBTztnQkFBUytELE1BQU07WUFBSyxHQUFHOUQsRUFBRSxDQUFDLFdBQVdQLFFBQVFVLEVBQUUsQ0FBQyxZQUFZO1lBQ2hILElBQUksQ0FBQ2xCLFFBQVEsQ0FBQ1ksSUFBSSxDQUFDLFlBQVlDLE1BQU0sQ0FBQyxLQUFLO2dCQUFFQyxPQUFPO2dCQUFTK0QsTUFBTTtZQUFLLEdBQUc5RCxFQUFFLENBQUMsV0FBV1AsUUFBUVcsR0FBRyxDQUFDLFlBQVksTUFBTTtTQUN2SDtRQUVELE9BQU87WUFDTmtDLE9BQU8sTUFBT3ZDLEtBQUssSUFBZTtZQUNsQzJELFFBQVEsT0FBUTNELEtBQUssSUFBZTtZQUNwQzRELFdBQVcsVUFBVzVELEtBQUssSUFBZTtZQUMxQ2dFLFdBQVc7UUFDWjtJQUNEO0FBQ0QiLCJzb3VyY2VzIjpbIkQ6XFxEZWx0YSBJVlxcU29md2FyZXNcXGdsYXNzXFxzYW5kYm94XFxzaGFkY24tY3JtLWRhc2hib2FyZFxcc3JjXFxzZXJ2ZXJcXHJlcG9zaXRvcmllc1xcc2Vzc2lvbnMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJ1xuXG4vLyBVc2UgdW50eXBlZCBjbGllbnQgdW50aWwgc2NoZW1hIGlzIGFwcGxpZWQgYW5kIHR5cGVzIHJlZ2VuZXJhdGVkXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCFcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIVxuY29uc3QgZGVmYXVsdENsaWVudCA9IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VBbm9uS2V5KVxuXG4vLyBUZW1wb3JhcnkgdHlwZXMgdW50aWwgc2NoZW1hIGlzIGFwcGxpZWRcbnR5cGUgU2Vzc2lvbiA9IGFueVxudHlwZSBTZXNzaW9uSW5zZXJ0ID0gYW55XG50eXBlIFNlc3Npb25VcGRhdGUgPSBhbnlcblxudHlwZSBTdXBhYmFzZUNsaWVudEFueSA9IHR5cGVvZiBkZWZhdWx0Q2xpZW50XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2Vzc2lvbkZpbHRlcnMge1xuXHRzZWFyY2g/OiBzdHJpbmdcblx0c3RhdHVzPzogJ2FsbCcgfCAnYWN0aXZlJyB8ICdjb21wbGV0ZWQnIHwgJ2NhbmNlbGxlZCdcblx0ZGF0ZUZyb20/OiBzdHJpbmdcblx0ZGF0ZVRvPzogc3RyaW5nXG5cdHR5cGU/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXNzaW9uTGlzdE9wdGlvbnMge1xuXHRmaWx0ZXJzPzogU2Vzc2lvbkZpbHRlcnNcblx0c29ydD86IHN0cmluZ1xuXHRkaXJlY3Rpb24/OiAnYXNjJyB8ICdkZXNjJ1xuXHRwYWdlPzogbnVtYmVyXG5cdHBhZ2VTaXplPzogbnVtYmVyXG5cdHVzZXJJZDogc3RyaW5nXG59XG5cbmZ1bmN0aW9uIG1hcERiU2Vzc2lvbihyb3c6IGFueSk6IGFueSB7XG5cdGNvbnN0IHN0YXJ0ZWRBdCA9IHJvdy5zdGFydGVkX2F0ID8gbmV3IERhdGUocm93LnN0YXJ0ZWRfYXQpIDogbnVsbFxuXHRjb25zdCBmYWxsYmFja1RpdGxlID0gc3RhcnRlZEF0ID8gYFNlc3Npb24gQCAke3N0YXJ0ZWRBdC50b0xvY2FsZVRpbWVTdHJpbmcoJ2VuLUdCJywgeyBob3VyMTI6IGZhbHNlIH0pfWAgOiAnU2Vzc2lvbidcblx0Ly8gSGV1cmlzdGljOiBpZiB0aXRsZV9lbmMgbG9va3MgbGlrZSBiYXNlNjQvb3BhcXVlLCB1c2UgZmFsbGJhY2sgZm9yIGRpc3BsYXlcblx0Y29uc3QgbG9va3NFbmNvZGVkID0gdHlwZW9mIHJvdy50aXRsZV9lbmMgPT09ICdzdHJpbmcnICYmIC9eW0EtWmEtejAtOSsvPV17MjAsfSQvLnRlc3Qocm93LnRpdGxlX2VuYylcblx0cmV0dXJuIHtcblx0XHRpZDogcm93LmlkLFxuXHRcdG93bmVyX2lkOiByb3cudXNlcl9pZCxcblx0XHRzdWJqZWN0X2lkOiByb3cuc3ViamVjdF9pZCB8fCBudWxsLFxuXHRcdHRpdGxlOiAocm93LnRpdGxlX2VuYyAmJiAhbG9va3NFbmNvZGVkKSA/IHJvdy50aXRsZV9lbmMgOiBmYWxsYmFja1RpdGxlLFxuXHRcdHR5cGU6IHJvdy5zZXNzaW9uX3R5cGUsXG5cdFx0c3RhdHVzOiByb3cuZW5kZWRfYXQgPyAnY29tcGxldGVkJyA6ICdhY3RpdmUnLFxuXHRcdHN0YXJ0ZWRfYXQ6IHJvdy5zdGFydGVkX2F0LFxuXHRcdGVuZGVkX2F0OiByb3cuZW5kZWRfYXQsXG5cdFx0Y3JlYXRlZF9hdDogcm93LnN0YXJ0ZWRfYXQsXG5cdFx0dXBkYXRlZF9hdDogcm93LnVwZGF0ZWRfYXQsXG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFNlc3Npb25zUmVwb3NpdG9yeSB7XG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBzdXBhYmFzZTogU3VwYWJhc2VDbGllbnRBbnkgPSBkZWZhdWx0Q2xpZW50KSB7fVxuXG4gICAgYXN5bmMgZmluZEFsbChvcHRpb25zOiBTZXNzaW9uTGlzdE9wdGlvbnMpOiBQcm9taXNlPHtcbiAgICAgICAgc2Vzc2lvbnM6IFNlc3Npb25bXVxuICAgICAgICB0b3RhbDogbnVtYmVyXG4gICAgICAgIHBhZ2U6IG51bWJlclxuICAgICAgICBwYWdlU2l6ZTogbnVtYmVyXG4gICAgICAgIHRvdGFsUGFnZXM6IG51bWJlclxuICAgIH0+IHtcblx0XHRjb25zdCB7XG5cdFx0XHRmaWx0ZXJzID0ge30sXG5cdFx0XHRzb3J0ID0gJ3N0YXJ0ZWRfYXQnLFxuXHRcdFx0ZGlyZWN0aW9uID0gJ2Rlc2MnLFxuXHRcdFx0cGFnZSA9IDEsXG5cdFx0XHRwYWdlU2l6ZSA9IDEwLFxuXHRcdFx0dXNlcklkXG5cdFx0fSA9IG9wdGlvbnNcblxuXHRcdGNvbnN0IHNvcnRDb2x1bW4gPSBbJ3N0YXJ0ZWRfYXQnLCd1cGRhdGVkX2F0JywnZW5kZWRfYXQnXS5pbmNsdWRlcyhzb3J0KSA/IHNvcnQgOiAnc3RhcnRlZF9hdCdcblxuXHRcdGxldCBxdWVyeSA9IHRoaXMuc3VwYWJhc2Vcblx0XHRcdC5mcm9tKCdzZXNzaW9ucycpXG5cdFx0XHQuc2VsZWN0KCdpZCx1c2VyX2lkLHN1YmplY3RfaWQsdGl0bGVfZW5jLHNlc3Npb25fdHlwZSxzdGFydGVkX2F0LGVuZGVkX2F0LHVwZGF0ZWRfYXQnLCB7IGNvdW50OiAnZXN0aW1hdGVkJyB9KVxuXHRcdFx0LmVxKCd1c2VyX2lkJywgdXNlcklkKVxuXG5cdFx0Ly8gQXBwbHkgZmlsdGVyc1xuXHRcdGlmIChmaWx0ZXJzLnNlYXJjaCkge1xuXHRcdFx0cXVlcnkgPSBxdWVyeS5pbGlrZSgndGl0bGVfZW5jJywgYCUke2ZpbHRlcnMuc2VhcmNofSVgKVxuXHRcdH1cblxuXHRcdGlmIChmaWx0ZXJzLnN0YXR1cyAmJiBmaWx0ZXJzLnN0YXR1cyAhPT0gJ2FsbCcpIHtcblx0XHRcdGlmIChmaWx0ZXJzLnN0YXR1cyA9PT0gJ2FjdGl2ZScpIHtcblx0XHRcdFx0cXVlcnkgPSBxdWVyeS5pcygnZW5kZWRfYXQnLCBudWxsKVxuXHRcdFx0fSBlbHNlIGlmIChmaWx0ZXJzLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcgfHwgZmlsdGVycy5zdGF0dXMgPT09ICdjYW5jZWxsZWQnKSB7XG5cdFx0XHRcdHF1ZXJ5ID0gcXVlcnkubm90KCdlbmRlZF9hdCcsICdpcycsIG51bGwpXG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKGZpbHRlcnMudHlwZSkge1xuXHRcdFx0cXVlcnkgPSBxdWVyeS5lcSgnc2Vzc2lvbl90eXBlJywgZmlsdGVycy50eXBlKVxuXHRcdH1cblxuXHRcdGlmIChmaWx0ZXJzLmRhdGVGcm9tKSB7XG5cdFx0XHRxdWVyeSA9IHF1ZXJ5Lmd0ZSgnc3RhcnRlZF9hdCcsIGZpbHRlcnMuZGF0ZUZyb20pXG5cdFx0fVxuXG5cdFx0aWYgKGZpbHRlcnMuZGF0ZVRvKSB7XG5cdFx0XHRxdWVyeSA9IHF1ZXJ5Lmx0ZSgnc3RhcnRlZF9hdCcsIGZpbHRlcnMuZGF0ZVRvKVxuXHRcdH1cblxuXHRcdC8vIEFwcGx5IHNvcnRpbmdcblx0XHRxdWVyeSA9IHF1ZXJ5Lm9yZGVyKHNvcnRDb2x1bW4sIHsgYXNjZW5kaW5nOiBkaXJlY3Rpb24gPT09ICdhc2MnIH0pXG5cblx0XHQvLyBBcHBseSBwYWdpbmF0aW9uICgxLWJhc2VkIHRvIDAtYmFzZWQgY29udmVyc2lvbilcblx0XHRjb25zdCBmcm9tID0gKHBhZ2UgLSAxKSAqIHBhZ2VTaXplXG5cdFx0Y29uc3QgdG8gPSBmcm9tICsgcGFnZVNpemUgLSAxXG5cdFx0cXVlcnkgPSBxdWVyeS5yYW5nZShmcm9tLCB0bylcblxuICAgICAgICBjb25zdCB7IGRhdGE6IHJvd3MsIGVycm9yLCBjb3VudCB9ID0gYXdhaXQgcXVlcnlcblxuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIHNlc3Npb25zOiAke2Vycm9yLm1lc3NhZ2V9YClcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJhc2VSb3dzID0gcm93cyB8fCBbXVxuXG4gICAgICAgIC8vIEVucmljaCB3aXRoIGNvbnRhY3QgcGhvbmUgdmlhIHN1YmplY3QgbG9va3VwIChwcmVmZXIgY3VzdG9tZXIgb3ZlciBsZWFkKVxuICAgICAgICBjb25zdCBwaG9uZUJ5U3ViamVjdDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XG4gICAgICAgIGNvbnN0IHN1YmplY3RJZHMgPSBBcnJheS5mcm9tKG5ldyBTZXQoXG4gICAgICAgICAgICBiYXNlUm93cy5tYXAoKHI6IGFueSkgPT4gci5zdWJqZWN0X2lkKS5maWx0ZXIoKHY6IGFueSkgPT4gISF2KVxuICAgICAgICApKSBhcyBzdHJpbmdbXVxuXG4gICAgICAgIGlmIChzdWJqZWN0SWRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIEZldGNoIGN1c3RvbWVyIHBob25lcyBpbiBidWxrXG4gICAgICAgICAgICBjb25zdCB7IGRhdGE6IGN1c3RSb3dzLCBlcnJvcjogY3VzdEVyciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgICAgICAgICAgIC5mcm9tKCdjdXN0b21lcnMnKVxuICAgICAgICAgICAgICAgIC5zZWxlY3QoJ3N1YmplY3RfaWQsIHBob25lJylcbiAgICAgICAgICAgICAgICAuaW4oJ3N1YmplY3RfaWQnLCBzdWJqZWN0SWRzKVxuICAgICAgICAgICAgICAgIC5lcSgnb3duZXJfaWQnLCB1c2VySWQpXG4gICAgICAgICAgICBpZiAoIWN1c3RFcnIgJiYgQXJyYXkuaXNBcnJheShjdXN0Um93cykpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHIgb2YgY3VzdFJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHIuc3ViamVjdF9pZCAmJiByLnBob25lKSBwaG9uZUJ5U3ViamVjdFtyLnN1YmplY3RfaWRdID0gci5waG9uZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRmV0Y2ggbGVhZCBwaG9uZXMgd2hlcmUgY3VzdG9tZXIgbWlzc2luZ1xuICAgICAgICAgICAgY29uc3QgbWlzc2luZyA9IHN1YmplY3RJZHMuZmlsdGVyKGlkID0+ICFwaG9uZUJ5U3ViamVjdFtpZF0pXG4gICAgICAgICAgICBpZiAobWlzc2luZy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBkYXRhOiBsZWFkUm93cyB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgICAgICAgICAgICAgICAuZnJvbSgnbGVhZHMnKVxuICAgICAgICAgICAgICAgICAgICAuc2VsZWN0KCdzdWJqZWN0X2lkLCBwaG9uZScpXG4gICAgICAgICAgICAgICAgICAgIC5pbignc3ViamVjdF9pZCcsIG1pc3NpbmcpXG4gICAgICAgICAgICAgICAgICAgIC5lcSgnb3duZXJfaWQnLCB1c2VySWQpXG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobGVhZFJvd3MpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgciBvZiBsZWFkUm93cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIuc3ViamVjdF9pZCAmJiByLnBob25lICYmICFwaG9uZUJ5U3ViamVjdFtyLnN1YmplY3RfaWRdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmVCeVN1YmplY3Rbci5zdWJqZWN0X2lkXSA9IHIucGhvbmVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHNlc3Npb25zID0gYmFzZVJvd3MubWFwKChyOiBhbnkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBtYXBEYlNlc3Npb24ocilcbiAgICAgICAgICAgIGNvbnN0IHBob25lID0gci5zdWJqZWN0X2lkID8gcGhvbmVCeVN1YmplY3Rbci5zdWJqZWN0X2lkXSA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgcmV0dXJuIHBob25lID8geyAuLi5zLCBwaG9uZSB9IDogc1xuICAgICAgICB9KVxuICAgICAgICBjb25zdCB0b3RhbCA9IGNvdW50IHx8IDBcbiAgICAgICAgY29uc3QgdG90YWxQYWdlcyA9IE1hdGguY2VpbCh0b3RhbCAvIHBhZ2VTaXplKVxuXG4gICAgICAgIHJldHVybiB7IHNlc3Npb25zLCB0b3RhbCwgcGFnZSwgcGFnZVNpemUsIHRvdGFsUGFnZXMgfVxuICAgIH1cblxuXHRhc3luYyBmaW5kQnlJZChpZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8U2Vzc2lvbiB8IG51bGw+IHtcblx0XHRjb25zdCB7IGRhdGE6IHJvdywgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2Vcblx0XHRcdC5mcm9tKCdzZXNzaW9ucycpXG5cdFx0XHQuc2VsZWN0KCdpZCx1c2VyX2lkLHN1YmplY3RfaWQsdGl0bGVfZW5jLHNlc3Npb25fdHlwZSxzdGFydGVkX2F0LGVuZGVkX2F0LHVwZGF0ZWRfYXQnKVxuXHRcdFx0LmVxKCdpZCcsIGlkKVxuXHRcdFx0LmVxKCd1c2VyX2lkJywgdXNlcklkKVxuXHRcdFx0LnNpbmdsZSgpXG5cblx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdGlmICgoZXJyb3IgYXMgYW55KS5jb2RlID09PSAnUEdSU1QxMTYnKSB7XG5cdFx0XHRcdHJldHVybiBudWxsIC8vIE5vdCBmb3VuZFxuXHRcdFx0fVxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggc2Vzc2lvbjogJHtlcnJvci5tZXNzYWdlfWApXG5cdFx0fVxuXG5cdFx0cmV0dXJuIG1hcERiU2Vzc2lvbihyb3cpXG5cdH1cblxuXHRhc3luYyBjcmVhdGUoc2Vzc2lvbkRhdGE6IFNlc3Npb25JbnNlcnQsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxTZXNzaW9uPiB7XG5cdFx0Y29uc3QgcmVxdWVzdGVkVHlwZSA9IChzZXNzaW9uRGF0YSBhcyBhbnkpPy50eXBlIHx8ICdhc2snXG5cdFx0Y29uc3QgeyBkYXRhOiBuZXdTZXNzaW9uSWQsIGVycm9yOiBycGNFcnJvciB9ID0gYXdhaXQgKHRoaXMuc3VwYWJhc2UgYXMgYW55KVxuXHRcdFx0LnJwYygnZ2V0X29yX2NyZWF0ZV9hY3RpdmVfc2Vzc2lvbicsIHsgcmVxdWVzdGVkX3R5cGU6IHJlcXVlc3RlZFR5cGUgfSlcblxuXHRcdGlmIChycGNFcnJvcikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIHNlc3Npb246ICR7cnBjRXJyb3IubWVzc2FnZX1gKVxuXHRcdH1cblxuXHRcdGNvbnN0IHsgZGF0YTogcm93LCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuXHRcdFx0LmZyb20oJ3Nlc3Npb25zJylcblx0XHRcdC5zZWxlY3QoJ2lkLHVzZXJfaWQsc3ViamVjdF9pZCx0aXRsZV9lbmMsc2Vzc2lvbl90eXBlLHN0YXJ0ZWRfYXQsZW5kZWRfYXQsdXBkYXRlZF9hdCcpXG5cdFx0XHQuZXEoJ2lkJywgbmV3U2Vzc2lvbklkKVxuXHRcdFx0LmVxKCd1c2VyX2lkJywgdXNlcklkKVxuXHRcdFx0LnNpbmdsZSgpXG5cblx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIGNyZWF0ZWQgc2Vzc2lvbjogJHtlcnJvci5tZXNzYWdlfWApXG5cdFx0fVxuXG5cdFx0cmV0dXJuIG1hcERiU2Vzc2lvbihyb3cpXG5cdH1cblxuXHRhc3luYyB1cGRhdGUoaWQ6IHN0cmluZywgc2Vzc2lvbkRhdGE6IFNlc3Npb25VcGRhdGUsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxTZXNzaW9uPiB7XG5cdFx0Ly8gU3VwcG9ydCB0aXRsZSB1cGRhdGUgYW5kIGVuZGluZyBhIHNlc3Npb25cblx0XHRpZiAoKHNlc3Npb25EYXRhIGFzIGFueSk/LnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcgfHwgKHNlc3Npb25EYXRhIGFzIGFueSk/LnN0YXR1cyA9PT0gJ2NhbmNlbGxlZCcpIHtcblx0XHRcdGNvbnN0IHsgZXJyb3I6IGVuZEVyciB9ID0gYXdhaXQgKHRoaXMuc3VwYWJhc2UgYXMgYW55KS5ycGMoJ2VuZF9zZXNzaW9uJywgeyBzZXNzaW9uX2lkOiBpZCB9KVxuXHRcdFx0aWYgKGVuZEVycikgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZW5kIHNlc3Npb246ICR7ZW5kRXJyLm1lc3NhZ2V9YClcblx0XHR9XG5cblx0XHRpZiAoKHNlc3Npb25EYXRhIGFzIGFueSk/LnRpdGxlKSB7XG5cdFx0XHRjb25zdCB7IGVycm9yOiB1cGRFcnIgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2Vcblx0XHRcdFx0LmZyb20oJ3Nlc3Npb25zJylcblx0XHRcdFx0LnVwZGF0ZSh7IHRpdGxlX2VuYzogKHNlc3Npb25EYXRhIGFzIGFueSkudGl0bGUgfSlcblx0XHRcdFx0LmVxKCdpZCcsIGlkKVxuXHRcdFx0XHQuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG5cdFx0XHRpZiAodXBkRXJyKSB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byB1cGRhdGUgc2Vzc2lvbjogJHt1cGRFcnIubWVzc2FnZX1gKVxuXHRcdH1cblxuXHRcdGNvbnN0IHsgZGF0YTogcm93LCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuXHRcdFx0LmZyb20oJ3Nlc3Npb25zJylcblx0XHRcdC5zZWxlY3QoJ2lkLHVzZXJfaWQsc3ViamVjdF9pZCx0aXRsZV9lbmMsc2Vzc2lvbl90eXBlLHN0YXJ0ZWRfYXQsZW5kZWRfYXQsdXBkYXRlZF9hdCcpXG5cdFx0XHQuZXEoJ2lkJywgaWQpXG5cdFx0XHQuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG5cdFx0XHQuc2luZ2xlKClcblx0XHRpZiAoZXJyb3IpIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIHNlc3Npb246ICR7ZXJyb3IubWVzc2FnZX1gKVxuXHRcdHJldHVybiBtYXBEYlNlc3Npb24ocm93KVxuXHR9XG5cblx0YXN5bmMgZGVsZXRlKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgeyBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuXHRcdFx0LmZyb20oJ3Nlc3Npb25zJylcblx0XHRcdC5kZWxldGUoKVxuXHRcdFx0LmVxKCdpZCcsIGlkKVxuXHRcdFx0LmVxKCd1c2VyX2lkJywgdXNlcklkKVxuXHRcdGlmIChlcnJvcikgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZGVsZXRlIHNlc3Npb246ICR7ZXJyb3IubWVzc2FnZX1gKVxuXHR9XG5cblx0YXN5bmMgZ2V0U3RhdHModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHtcblx0XHR0b3RhbDogbnVtYmVyXG5cdFx0YWN0aXZlOiBudW1iZXJcblx0XHRjb21wbGV0ZWQ6IG51bWJlclxuXHRcdGNhbmNlbGxlZDogbnVtYmVyXG5cdH0+IHtcblx0XHRjb25zdCBbdG90YWwsIGFjdGl2ZSwgY29tcGxldGVkXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcblx0XHRcdHRoaXMuc3VwYWJhc2UuZnJvbSgnc2Vzc2lvbnMnKS5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pLmVxKCd1c2VyX2lkJywgdXNlcklkKSxcblx0XHRcdHRoaXMuc3VwYWJhc2UuZnJvbSgnc2Vzc2lvbnMnKS5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pLmVxKCd1c2VyX2lkJywgdXNlcklkKS5pcygnZW5kZWRfYXQnLCBudWxsKSxcblx0XHRcdHRoaXMuc3VwYWJhc2UuZnJvbSgnc2Vzc2lvbnMnKS5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pLmVxKCd1c2VyX2lkJywgdXNlcklkKS5ub3QoJ2VuZGVkX2F0JywgJ2lzJywgbnVsbCksXG5cdFx0XSlcblxuXHRcdHJldHVybiB7XG5cdFx0XHR0b3RhbDogKHRvdGFsLmNvdW50IGFzIG51bWJlcikgfHwgMCxcblx0XHRcdGFjdGl2ZTogKGFjdGl2ZS5jb3VudCBhcyBudW1iZXIpIHx8IDAsXG5cdFx0XHRjb21wbGV0ZWQ6IChjb21wbGV0ZWQuY291bnQgYXMgbnVtYmVyKSB8fCAwLFxuXHRcdFx0Y2FuY2VsbGVkOiAwLFxuXHRcdH1cblx0fVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlQW5vbktleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiZGVmYXVsdENsaWVudCIsIm1hcERiU2Vzc2lvbiIsInJvdyIsInN0YXJ0ZWRBdCIsInN0YXJ0ZWRfYXQiLCJEYXRlIiwiZmFsbGJhY2tUaXRsZSIsInRvTG9jYWxlVGltZVN0cmluZyIsImhvdXIxMiIsImxvb2tzRW5jb2RlZCIsInRpdGxlX2VuYyIsInRlc3QiLCJpZCIsIm93bmVyX2lkIiwidXNlcl9pZCIsInN1YmplY3RfaWQiLCJ0aXRsZSIsInR5cGUiLCJzZXNzaW9uX3R5cGUiLCJzdGF0dXMiLCJlbmRlZF9hdCIsImNyZWF0ZWRfYXQiLCJ1cGRhdGVkX2F0IiwiU2Vzc2lvbnNSZXBvc2l0b3J5IiwiY29uc3RydWN0b3IiLCJzdXBhYmFzZSIsImZpbmRBbGwiLCJvcHRpb25zIiwiZmlsdGVycyIsInNvcnQiLCJkaXJlY3Rpb24iLCJwYWdlIiwicGFnZVNpemUiLCJ1c2VySWQiLCJzb3J0Q29sdW1uIiwiaW5jbHVkZXMiLCJxdWVyeSIsImZyb20iLCJzZWxlY3QiLCJjb3VudCIsImVxIiwic2VhcmNoIiwiaWxpa2UiLCJpcyIsIm5vdCIsImRhdGVGcm9tIiwiZ3RlIiwiZGF0ZVRvIiwibHRlIiwib3JkZXIiLCJhc2NlbmRpbmciLCJ0byIsInJhbmdlIiwiZGF0YSIsInJvd3MiLCJlcnJvciIsIkVycm9yIiwibWVzc2FnZSIsImJhc2VSb3dzIiwicGhvbmVCeVN1YmplY3QiLCJzdWJqZWN0SWRzIiwiQXJyYXkiLCJTZXQiLCJtYXAiLCJyIiwiZmlsdGVyIiwidiIsImxlbmd0aCIsImN1c3RSb3dzIiwiY3VzdEVyciIsImluIiwiaXNBcnJheSIsInBob25lIiwibWlzc2luZyIsImxlYWRSb3dzIiwic2Vzc2lvbnMiLCJzIiwidW5kZWZpbmVkIiwidG90YWwiLCJ0b3RhbFBhZ2VzIiwiTWF0aCIsImNlaWwiLCJmaW5kQnlJZCIsInNpbmdsZSIsImNvZGUiLCJjcmVhdGUiLCJzZXNzaW9uRGF0YSIsInJlcXVlc3RlZFR5cGUiLCJuZXdTZXNzaW9uSWQiLCJycGNFcnJvciIsInJwYyIsInJlcXVlc3RlZF90eXBlIiwidXBkYXRlIiwiZW5kRXJyIiwic2Vzc2lvbl9pZCIsInVwZEVyciIsImRlbGV0ZSIsImdldFN0YXRzIiwiYWN0aXZlIiwiY29tcGxldGVkIiwiUHJvbWlzZSIsImFsbCIsImhlYWQiLCJjYW5jZWxsZWQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/server/repositories/sessions.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!*********************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \*********************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1","vendor-chunks/tr46@0.0.3","vendor-chunks/@supabase+auth-js@2.71.1","vendor-chunks/@supabase+realtime-js@2.15.5","vendor-chunks/@supabase+postgrest-js@1.21.4","vendor-chunks/@supabase+node-fetch@2.6.15","vendor-chunks/@supabase+storage-js@2.12.1","vendor-chunks/whatwg-url@5.0.0","vendor-chunks/@supabase+ssr@0.7.0_@supabase+supabase-js@2.57.4","vendor-chunks/@supabase+supabase-js@2.57.4","vendor-chunks/cookie@1.0.2","vendor-chunks/@supabase+functions-js@2.4.6","vendor-chunks/webidl-conversions@3.0.1"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@15.2.2_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fsessions%2Froute&page=%2Fapi%2Fsessions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsessions%2Froute.ts&appDir=D%3A%5CDelta%20IV%5CSofwares%5Cglass%5Csandbox%5Cshadcn-crm-dashboard%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CDelta%20IV%5CSofwares%5Cglass%5Csandbox%5Cshadcn-crm-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();